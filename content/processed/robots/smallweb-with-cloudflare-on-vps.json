{
  "content": "<p class=\"\">I'll create a detailed walkthrough of how we got this stack working:</p>\n<h3 class=\"\" id=\"stack-overview\">Stack Overview</h3>\n<ul class=\"list-disc\">\n<li class=\"\">Smallweb serving on port 7777</li>\n<li class=\"\">Datasette running on port 8002 (as an example of another service)</li>\n<li class=\"\">Caddy as the local reverse proxy on port 80</li>\n<li class=\"\">Cloudflare Tunnel routing all <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">*.tools.ejfox.com</code> traffic to the VPS</li>\n<li class=\"\">SSL handled by Cloudflare</li>\n</ul>\n<h3 class=\"\" id=\"configuration-steps\">Configuration Steps</h3>\n<h4 class=\"\" id=\"1-initial-setup\">1. Initial Setup</h4>\n<ul class=\"list-disc\">\n<li class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">~/smallweb</code> directory</li>\n<li class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">~/smallweb/.smallweb/config.json</code> with:</li>\n</ul>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"json\" data-theme=\"\"><code data-language=\"json\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#CCCAC2\">{</span></span>\n<span data-line=\"\"><span style=\"color:#5CCFE6\">  \"domain\"</span><span style=\"color:#CCCAC2B3\">:</span><span style=\"color:#D5FF80\"> \"tools.ejfox.com\"</span></span>\n<span data-line=\"\"><span style=\"color:#CCCAC2\">}</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"{\n  &#x22;domain&#x22;: &#x22;tools.ejfox.com&#x22;\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ul class=\"list-disc\">\n<li class=\"\">Smallweb process running as debian user: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">/home/debian/.local/bin/smallweb up --cron</code></li>\n</ul>\n<h4 class=\"\" id=\"2-cloudflare-tunnel-configuration\">2. Cloudflare Tunnel Configuration</h4>\n<ul class=\"list-disc\">\n<li class=\"\">Created tunnel named <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">ejfox.com</code> through Cloudflare dashboard</li>\n<li class=\"\">Set up public hostname:\n<ul class=\"list-disc\">\n<li class=\"\">Subdomain: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">*.tools</code></li>\n<li class=\"\">Domain: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">ejfox.com</code></li>\n<li class=\"\">Path: (empty)</li>\n<li class=\"\">Service: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">http://localhost:80</code> (pointing to Caddy)</li>\n</ul>\n</li>\n</ul>\n<h4 class=\"\" id=\"3-caddy-configuration\">3. Caddy Configuration</h4>\n<p class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">/etc/caddy/Caddyfile</code>:</p>\n<pre class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\"><code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">{\n    # Globally disable automatic HTTPS since Cloudflare handles it\n    auto_https off\n}\n\n# Development routes\n:80, localhost:80, *.localhost:80 {\n    reverse_proxy localhost:7777\n}\n\n# Production routes for tools subdomains\nhttp://*.tools.ejfox.com {\n    @datasette host datasette.tools.ejfox.com\n    handle @datasette {\n        reverse_proxy localhost:8002\n    }\n\n    handle {\n        reverse_proxy localhost:7777\n    }\n}\n</code></pre>\n<h4 class=\"\" id=\"4-running-the-services\">4. Running the Services</h4>\n<ol class=\"list-decimal\">\n<li class=\"\">Started smallweb:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">/home/debian/.local/bin/smallweb</span><span style=\"color:#D5FF80\"> up</span><span style=\"color:#95E6CB\"> --cron</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"/home/debian/.local/bin/smallweb up --cron\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ol start=\"2\" class=\"list-decimal\">\n<li class=\"\">Started Caddy:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> systemctl</span><span style=\"color:#D5FF80\"> restart</span><span style=\"color:#D5FF80\"> caddy</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"sudo systemctl restart caddy\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ol start=\"3\" class=\"list-decimal\">\n<li class=\"\">Started Cloudflare Tunnel:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> cloudflared</span><span style=\"color:#95E6CB\"> --no-autoupdate</span><span style=\"color:#D5FF80\"> tunnel</span><span style=\"color:#D5FF80\"> run</span><span style=\"color:#95E6CB\"> --token</span><span style=\"color:#F29E74\"> &#x3C;</span><span style=\"color:#D5FF80\">tunnel-toke</span><span style=\"color:#CCCAC2\">n</span><span style=\"color:#F29E74\">></span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"sudo cloudflared --no-autoupdate tunnel run --token <tunnel-token>\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<h3 class=\"\" id=\"key-learnings--notes\">Key Learnings &#x26; Notes</h3>\n<ol class=\"list-decimal\">\n<li class=\"\">Smallweb binds to both IPv4 and IPv6 (<code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">:::7777</code>)</li>\n<li class=\"\">Using Caddy as the central router allows for easy addition of new services</li>\n<li class=\"\">The stack allows for dynamic subdomain routing without modifying Cloudflare config</li>\n<li class=\"\">Running as the debian user worked fine (didn't need dedicated smallweb user)</li>\n<li class=\"\">Cloudflare Tunnel configuration needs to point to Caddy (port 80) rather than directly to smallweb</li>\n</ol>\n<h3 class=\"\" id=\"verification\">Verification</h3>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Check services</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> netstat</span><span style=\"color:#95E6CB\"> -tlpn</span><span style=\"color:#F29E74\"> |</span><span style=\"color:#73D0FF\"> grep</span><span style=\"color:#95E6CB\"> -E</span><span style=\"color:#D5FF80\"> ':(80|8002|7777)'</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp</span><span style=\"color:#DFBFFF\">        0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> 127.0.0.1:8002</span><span style=\"color:#D5FF80\">          0.0.0.0:</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">               LISTEN</span><span style=\"color:#D5FF80\">      11484/python3</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp6</span><span style=\"color:#DFBFFF\">       0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> :::7777</span><span style=\"color:#D5FF80\">                 :::</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">                    LISTEN</span><span style=\"color:#D5FF80\">      9009/smallweb</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp6</span><span style=\"color:#DFBFFF\">       0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> :::80</span><span style=\"color:#D5FF80\">                   :::</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">                    LISTEN</span><span style=\"color:#D5FF80\">      12890/caddy</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Verify smallweb</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">smallweb</span><span style=\"color:#D5FF80\"> doctor</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">smallweb</span><span style=\"color:#D5FF80\"> list</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Test endpoints</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">curl</span><span style=\"color:#D5FF80\"> https://example.tools.ejfox.com</span><span style=\"color:#B8CFE680;font-style:italic\">  # Returns \"Smallweb is running\"</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">curl</span><span style=\"color:#D5FF80\"> https://datasette.tools.ejfox.com</span><span style=\"color:#B8CFE680;font-style:italic\">  # Returns Datasette interface</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"# Check services\nsudo netstat -tlpn | grep -E &#x27;:(80|8002|7777)&#x27;\ntcp        0      0 127.0.0.1:8002          0.0.0.0:*               LISTEN      11484/python3\ntcp6       0      0 :::7777                 :::*                    LISTEN      9009/smallweb\ntcp6       0      0 :::80                   :::*                    LISTEN      12890/caddy\n\n# Verify smallweb\nsmallweb doctor\nsmallweb list\n\n# Test endpoints\ncurl https://example.tools.ejfox.com  # Returns &#x22;Smallweb is running&#x22;\ncurl https://datasette.tools.ejfox.com  # Returns Datasette interface\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<h3 class=\"\" id=\"final-result\">Final Result</h3>\n<ul class=\"list-disc\">\n<li class=\"\">All traffic encrypted via Cloudflare</li>\n<li class=\"\">Dynamic subdomain routing working</li>\n<li class=\"\">Multiple services running behind single domain</li>\n<li class=\"\">Easy to add new services or smallweb sites</li>\n</ul>\n<p class=\"\">Let me know if you'd like me to expand on any part of this documentation!</p>",
  "html": "<p class=\"\">I'll create a detailed walkthrough of how we got this stack working:</p>\n<h3 class=\"\" id=\"stack-overview\">Stack Overview</h3>\n<ul class=\"list-disc\">\n<li class=\"\">Smallweb serving on port 7777</li>\n<li class=\"\">Datasette running on port 8002 (as an example of another service)</li>\n<li class=\"\">Caddy as the local reverse proxy on port 80</li>\n<li class=\"\">Cloudflare Tunnel routing all <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">*.tools.ejfox.com</code> traffic to the VPS</li>\n<li class=\"\">SSL handled by Cloudflare</li>\n</ul>\n<h3 class=\"\" id=\"configuration-steps\">Configuration Steps</h3>\n<h4 class=\"\" id=\"1-initial-setup\">1. Initial Setup</h4>\n<ul class=\"list-disc\">\n<li class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">~/smallweb</code> directory</li>\n<li class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">~/smallweb/.smallweb/config.json</code> with:</li>\n</ul>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"json\" data-theme=\"\"><code data-language=\"json\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#CCCAC2\">{</span></span>\n<span data-line=\"\"><span style=\"color:#5CCFE6\">  \"domain\"</span><span style=\"color:#CCCAC2B3\">:</span><span style=\"color:#D5FF80\"> \"tools.ejfox.com\"</span></span>\n<span data-line=\"\"><span style=\"color:#CCCAC2\">}</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"{\n  &#x22;domain&#x22;: &#x22;tools.ejfox.com&#x22;\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ul class=\"list-disc\">\n<li class=\"\">Smallweb process running as debian user: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">/home/debian/.local/bin/smallweb up --cron</code></li>\n</ul>\n<h4 class=\"\" id=\"2-cloudflare-tunnel-configuration\">2. Cloudflare Tunnel Configuration</h4>\n<ul class=\"list-disc\">\n<li class=\"\">Created tunnel named <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">ejfox.com</code> through Cloudflare dashboard</li>\n<li class=\"\">Set up public hostname:\n<ul class=\"list-disc\">\n<li class=\"\">Subdomain: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">*.tools</code></li>\n<li class=\"\">Domain: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">ejfox.com</code></li>\n<li class=\"\">Path: (empty)</li>\n<li class=\"\">Service: <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">http://localhost:80</code> (pointing to Caddy)</li>\n</ul>\n</li>\n</ul>\n<h4 class=\"\" id=\"3-caddy-configuration\">3. Caddy Configuration</h4>\n<p class=\"\">Created <code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">/etc/caddy/Caddyfile</code>:</p>\n<pre class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\"><code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">{\n    # Globally disable automatic HTTPS since Cloudflare handles it\n    auto_https off\n}\n\n# Development routes\n:80, localhost:80, *.localhost:80 {\n    reverse_proxy localhost:7777\n}\n\n# Production routes for tools subdomains\nhttp://*.tools.ejfox.com {\n    @datasette host datasette.tools.ejfox.com\n    handle @datasette {\n        reverse_proxy localhost:8002\n    }\n\n    handle {\n        reverse_proxy localhost:7777\n    }\n}\n</code></pre>\n<h4 class=\"\" id=\"4-running-the-services\">4. Running the Services</h4>\n<ol class=\"list-decimal\">\n<li class=\"\">Started smallweb:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">/home/debian/.local/bin/smallweb</span><span style=\"color:#D5FF80\"> up</span><span style=\"color:#95E6CB\"> --cron</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"/home/debian/.local/bin/smallweb up --cron\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ol start=\"2\" class=\"list-decimal\">\n<li class=\"\">Started Caddy:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> systemctl</span><span style=\"color:#D5FF80\"> restart</span><span style=\"color:#D5FF80\"> caddy</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"sudo systemctl restart caddy\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<ol start=\"3\" class=\"list-decimal\">\n<li class=\"\">Started Cloudflare Tunnel:</li>\n</ol>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> cloudflared</span><span style=\"color:#95E6CB\"> --no-autoupdate</span><span style=\"color:#D5FF80\"> tunnel</span><span style=\"color:#D5FF80\"> run</span><span style=\"color:#95E6CB\"> --token</span><span style=\"color:#F29E74\"> &#x3C;</span><span style=\"color:#D5FF80\">tunnel-toke</span><span style=\"color:#CCCAC2\">n</span><span style=\"color:#F29E74\">></span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"sudo cloudflared --no-autoupdate tunnel run --token <tunnel-token>\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<h3 class=\"\" id=\"key-learnings--notes\">Key Learnings &#x26; Notes</h3>\n<ol class=\"list-decimal\">\n<li class=\"\">Smallweb binds to both IPv4 and IPv6 (<code class=\"font-mono text-sm bg-zinc-100 dark:bg-zinc-800 rounded px-1.5 py-0.5\">:::7777</code>)</li>\n<li class=\"\">Using Caddy as the central router allows for easy addition of new services</li>\n<li class=\"\">The stack allows for dynamic subdomain routing without modifying Cloudflare config</li>\n<li class=\"\">Running as the debian user worked fine (didn't need dedicated smallweb user)</li>\n<li class=\"\">Cloudflare Tunnel configuration needs to point to Caddy (port 80) rather than directly to smallweb</li>\n</ol>\n<h3 class=\"\" id=\"verification\">Verification</h3>\n<figure class=\"relative rounded-lg overflow-hidden shadow-sm max-w-prose mx-auto\" data-rehype-pretty-code-figure=\"\"><pre style=\"background-color:#09090b;color:#cccac2\" tabindex=\"0\" data-language=\"bash\" data-theme=\"\"><code data-language=\"bash\" data-theme=\"\" style=\"display: grid;\"><span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Check services</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">sudo</span><span style=\"color:#D5FF80\"> netstat</span><span style=\"color:#95E6CB\"> -tlpn</span><span style=\"color:#F29E74\"> |</span><span style=\"color:#73D0FF\"> grep</span><span style=\"color:#95E6CB\"> -E</span><span style=\"color:#D5FF80\"> ':(80|8002|7777)'</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp</span><span style=\"color:#DFBFFF\">        0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> 127.0.0.1:8002</span><span style=\"color:#D5FF80\">          0.0.0.0:</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">               LISTEN</span><span style=\"color:#D5FF80\">      11484/python3</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp6</span><span style=\"color:#DFBFFF\">       0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> :::7777</span><span style=\"color:#D5FF80\">                 :::</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">                    LISTEN</span><span style=\"color:#D5FF80\">      9009/smallweb</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">tcp6</span><span style=\"color:#DFBFFF\">       0</span><span style=\"color:#DFBFFF\">      0</span><span style=\"color:#D5FF80\"> :::80</span><span style=\"color:#D5FF80\">                   :::</span><span style=\"color:#5CCFE6;font-style:italic\">*</span><span style=\"color:#D5FF80\">                    LISTEN</span><span style=\"color:#D5FF80\">      12890/caddy</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Verify smallweb</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">smallweb</span><span style=\"color:#D5FF80\"> doctor</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">smallweb</span><span style=\"color:#D5FF80\"> list</span></span>\n<span data-line=\"\"> </span>\n<span data-line=\"\"><span style=\"color:#B8CFE680;font-style:italic\"># Test endpoints</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">curl</span><span style=\"color:#D5FF80\"> https://example.tools.ejfox.com</span><span style=\"color:#B8CFE680;font-style:italic\">  # Returns \"Smallweb is running\"</span></span>\n<span data-line=\"\"><span style=\"color:#73D0FF\">curl</span><span style=\"color:#D5FF80\"> https://datasette.tools.ejfox.com</span><span style=\"color:#B8CFE680;font-style:italic\">  # Returns Datasette interface</span></span><button type=\"button\" title=\"Copy code\" aria-label=\"Copy code\" data=\"# Check services\nsudo netstat -tlpn | grep -E &#x27;:(80|8002|7777)&#x27;\ntcp        0      0 127.0.0.1:8002          0.0.0.0:*               LISTEN      11484/python3\ntcp6       0      0 :::7777                 :::*                    LISTEN      9009/smallweb\ntcp6       0      0 :::80                   :::*                    LISTEN      12890/caddy\n\n# Verify smallweb\nsmallweb doctor\nsmallweb list\n\n# Test endpoints\ncurl https://example.tools.ejfox.com  # Returns &#x22;Smallweb is running&#x22;\ncurl https://datasette.tools.ejfox.com  # Returns Datasette interface\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);\"><span class=\"ready\"></span><span class=\"success\"></span></button><style>:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>\n<h3 class=\"\" id=\"final-result\">Final Result</h3>\n<ul class=\"list-disc\">\n<li class=\"\">All traffic encrypted via Cloudflare</li>\n<li class=\"\">Dynamic subdomain routing working</li>\n<li class=\"\">Multiple services running behind single domain</li>\n<li class=\"\">Easy to add new services or smallweb sites</li>\n</ul>\n<p class=\"\">Let me know if you'd like me to expand on any part of this documentation!</p>",
  "title": "Setting up Smallweb with Cloudflare Tunnel and Caddy",
  "metadata": {
    "date": "2024-12-08T20:13:29.000Z",
    "modified": "2024-12-08T22:46:33.000Z",
    "share": true,
    "words": 393,
    "images": 0,
    "imageDetails": {
      "total": 0,
      "cloudinary": 0,
      "withDimensions": 0
    },
    "links": 0,
    "codeBlocks": 6,
    "headers": {
      "h2": 1
    },
    "toc": [
      {
        "text": "Setting up Smallweb with Cloudflare Tunnel and Caddy",
        "slug": "setting-up-smallweb-with-cloudflare-tunnel-and-caddy",
        "level": "h2",
        "children": [
          {
            "text": "Stack Overview",
            "slug": "stack-overview",
            "level": "h3",
            "children": []
          },
          {
            "text": "Configuration Steps",
            "slug": "configuration-steps",
            "level": "h3",
            "children": []
          },
          {
            "text": "Key Learnings & Notes",
            "slug": "key-learnings--notes",
            "level": "h3",
            "children": []
          },
          {
            "text": "Verification",
            "slug": "verification",
            "level": "h3",
            "children": []
          },
          {
            "text": "Final Result",
            "slug": "final-result",
            "level": "h3",
            "children": []
          }
        ]
      }
    ],
    "type": "post",
    "sourcePath": "../../../../../code/website2/content/blog/robots/smallweb-with-cloudflare-on-vps.md",
    "sourceDir": "/Users/ejfox/Library/Mobile Documents/iCloud~md~obsidian/Documents/ejfox/"
  }
}
